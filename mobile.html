<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>burn1ng.me â€” mobile panorama</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum/build/pannellum.css">
  <style>
    /* å…¨å±å ä½ï¼ˆå¤„ç†ç§»åŠ¨ç«¯åœ°å€æ /åˆ˜æµ·ï¼‰ï¼šä¼˜å…ˆ 100dvhï¼Œå›é€€ 100vh */
    html, body { height: 100%; margin: 0; background: #0b0b0b; overflow: hidden; }
    #pano {
      position: fixed; inset: 0;
      width: 100vw; height: 100dvh; /* åŠ¨æ€è§†å£é«˜åº¦ï¼ŒiOSæ›´ç¨³ */
      height: 100vh; /* å›é€€ */
    }

    /* çƒ­ç‚¹å®¹å™¨ */
    .hs-portal { pointer-events: auto; transform: translateZ(0); }

    /* çƒ­ç‚¹å›¾ç‰‡ï¼ˆè§¦æ‘¸æœ‰è½»è§¦åé¦ˆï¼›ç§»åŠ¨ç«¯ä¹Ÿå…¼å®¹ï¼‰ */
    .hs-portal .hs-img{
      width: 60px; height: 60px; /* ç§»åŠ¨ç«¯é»˜è®¤æ›´å°äº› */
      background: center / contain no-repeat;
      transition: transform .15s ease;
      touch-action: manipulation;
    }
    @media (min-width: 480px){ .hs-portal .hs-img{ width: 140px; height: 140px; } }
    .hs-portal .hs-img:hover{ transform: scale(1.06); }

    /* å¯é€‰æ–‡å­—æ ‡ç­¾ï¼ˆæœªä½¿ç”¨å¯ç•™ç€ï¼‰ */
    .hs-portal .hs-label{
      margin-top: 8px; text-align: center;
      font: 700 18px/1.1 "Helvetica Neue", Arial, sans-serif;
      color:#111; text-shadow: 0 1px 2px rgba(255,255,255,.6);
      pointer-events: none; user-select: none;
    }

    /* å¤±è´¥å…œåº•å±‚ */
    .fallback{
      position: fixed; inset: 0; display:none; place-items:center;
      background:#0b0b0b; color:#fff; padding: 24px; text-align:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    .fallback a{ color:#ff4d4f; }
  </style>
</head>
<body>
  <div id="pano" aria-label="Panorama"></div>
  <div id="fallback" class="fallback">
    <div>
      <h2 style="margin:0 0 12px">åŠ è½½å…¨æ™¯å¤±è´¥æˆ–è®¾å¤‡ä¸æ”¯æŒ WebGL</h2>
      <p style="margin:0 0 16px">ä½ å¯ä»¥è¿”å›æ¡Œé¢ç‰ˆæˆ–è½»é‡é¡µï¼š</p>
      <p>
        <a href="index.html?desktop=1">ğŸ‘‰ æ¡Œé¢ç‰ˆ</a>
        &nbsp;|&nbsp;
        <a href="/">ä¸»é¡µ</a>
      </p>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/pannellum/build/pannellum.js"></script>
  <script>
    // â€”â€” å¯é€‰ï¼šå¦‚æœä½ å‡†å¤‡äº†ç§»åŠ¨ç«¯ä¸“ç”¨ WebP/JPGï¼Œè¯·æŠŠä¸‹é¢çš„ PANO_URL æ¢æˆå®ƒä»¬ â€”â€”
    // ä¾‹ï¼šconst PANO_URL = supportsWebP ? 'pano-mobile-4k.webp' : 'pano-mobile-4k.jpg';

    // WebP èƒ½åŠ›æ£€æµ‹ï¼ˆå¦‚æœè¦ç”¨åŒæ ¼å¼æ—¶ï¼‰
    const supportsWebP = (function(){
      try { return document.createElement('canvas').toDataURL('image/webp').indexOf('data:image/webp') === 0; }
      catch(e){ return false; }
    })();

    // å½“å‰å…ˆç”¨ä½ çš„ R2 å…¨æ™¯ï¼ˆPNGï¼‰ã€‚åç»­è‹¥æœ‰ç§»åŠ¨ç«¯å›¾ï¼Œæ”¹æˆä¸Šé¢çš„åŒæ ¼å¼å†™æ³•å³å¯ã€‚
    const PANO_URL = 'æ‰‹æœº-01.webp';

    // 0) WebGL èƒ½åŠ›å…œåº•ï¼ˆéƒ¨åˆ†è€æœºæˆ–å†…ç½®æµè§ˆå™¨å¯èƒ½æ—  WebGLï¼‰
    (function ensureWebGL(){
      try{
        var c = document.createElement('canvas');
        var gl = c.getContext('webgl') || c.getContext('experimental-webgl');
        if(!gl) throw new Error('No WebGL');
      }catch(e){
        document.getElementById('fallback').style.display = 'grid';
        throw e;
      }
    })();

    // 1) åˆå§‹åŒ–å…¨æ™¯ï¼ˆç§»åŠ¨ç«¯ï¼šå›ºå®šè§†åœºè§’ï¼Œå‡å°‘ç¼©æ”¾å¸¦æ¥çš„å¼€é”€ï¼›ä¸å±•ç¤ºæ§åˆ¶æ¡ï¼‰
    const viewer = pannellum.viewer('pano', {
      type: 'equirectangular',
      panorama: PANO_URL,
      autoLoad: true,

      mouseZoom: false, keyboardZoom: false, doubleClickZoom: false, showZoomCtrl: false,
      showControls: false, compass: false,

      hfov: 90, minHfov: 90, maxHfov: 90,   // å›ºå®šè§†åœºè§’
      yaw: 0, pitch: 12,                    // åˆå§‹è§†è§’
      minYaw: -100, maxYaw: 100,
      minPitch: -40, maxPitch: 47,

      // æƒ³å¼€é™€èºä»ªå¯è®¾ä¸º trueï¼ˆiOS éœ€æ‰‹åŠ¨æˆæƒï¼‰
      orientationOnByDefault: true,

      hotSpots: [
        /* çƒ­ç‚¹ 1ï¼šWORK */
        {
          yaw: 4, pitch: 17, cssClass: 'hs-portal',
          createTooltipFunc: imageHotspot,
          createTooltipArgs: {
            width: 40,
            defaultUrl: 'https://i.postimg.cc/pLVStr1j/234-02.png',
            hoverUrl:   'https://i.postimg.cc/vTq8ZSfy/05.png',
            label: ''
          },
          clickHandlerFunc: navigateHotspot,
          clickHandlerArgs: { url: 'WORK.html', target: '_self' }
        },
        /* çƒ­ç‚¹ 2ï¼šABOUTï¼ˆå¦‚æœä½ æŠŠæ–‡ä»¶æ”¹å about.htmlï¼Œè®°å¾—åŒæ­¥è¿™é‡Œï¼‰ */
        {
          yaw: 1, pitch: 35, cssClass: 'hs-portal',
          createTooltipFunc: imageHotspot,
          createTooltipArgs: {
            width: 55,
            defaultUrl: 'https://i.postimg.cc/Qd02Mpcq/234-04.png',
            hoverUrl:   'https://i.postimg.cc/dQrHFYsJ/Inspo.png',
            label: ''
          },
          clickHandlerFunc: navigateHotspot,
          clickHandlerArgs: { url: 'ABOUT ME.html', target: '_self' }
        },
        /* çƒ­ç‚¹ 3ï¼šCONTACT */
        {
          yaw: 8, pitch: 4, cssClass: 'hs-portal',
          createTooltipFunc: imageHotspot,
          createTooltipArgs: {
            width: 45,
            defaultUrl: 'https://i.postimg.cc/nVswMmnY/hui-03.png',
            hoverUrl:   'https://i.postimg.cc/pVZYWXFY/Pinterest.png',
            label: ''
          },
          clickHandlerFunc: navigateHotspot,
          clickHandlerArgs: { url: 'CONTACT.html', target: '_self' }
        }
      ]
    });

    // 1.1) åŠ è½½å¤±è´¥å…œåº•ï¼ˆå›¾ç‰‡ 404 / CORS / ä½“ç§¯è¿‡å¤§ï¼‰
    try { viewer.on('error', function(){ document.getElementById('fallback').style.display = 'grid'; }); } catch(e){}

    // 2) é¢„åŠ è½½ hover å›¾ï¼Œå‡å°‘é¦–æ¬¡åˆ‡æ¢é—ª
    (function preload(){
      [
        'https://i.postimg.cc/vTq8ZSfy/05.png',
        'https://i.postimg.cc/dQrHFYsJ/Inspo.png',
        'https://i.postimg.cc/pVZYWXFY/Pinterest.png'
      ].forEach(src=>{
        const i = new Image(); i.referrerPolicy = 'no-referrer'; i.src = src;
      });
    })();

    // 3) è‡ªå®šä¹‰çƒ­ç‚¹ï¼šå›¾ç‰‡ + æ¡Œé¢ hover / ç§»åŠ¨è§¦æ‘¸è½»è§¦åé¦ˆ
    function imageHotspot(hotSpotDiv, args) {
      const imgBox = document.createElement('div');
      imgBox.className = 'hs-img';

      // å°ºå¯¸ï¼ˆç§»åŠ¨ç«¯æ›´å°ï¼Œè‹¥ä¼  width ç”¨å®ƒï¼‰
      if (args.width) {
        imgBox.style.width = args.width + 'px';
        imgBox.style.height = (args.height ? args.height : args.width) + 'px';
      }

      const normal = args.defaultUrl;
      const hover  = args.hoverUrl || args.defaultUrl;
      imgBox.style.backgroundImage = `url("${normal}")`;

      imgBox.addEventListener('mouseenter', () => { imgBox.style.backgroundImage = `url("${hover}")`; });
      imgBox.addEventListener('mouseleave', () => { imgBox.style.backgroundImage = `url("${normal}")`; });
      imgBox.addEventListener('touchstart', () => {
        imgBox.style.backgroundImage = `url("${hover}")`;
        setTimeout(()=>{ imgBox.style.backgroundImage = `url("${normal}")`; }, 180);
      }, {passive:true});

      hotSpotDiv.appendChild(imgBox);

      if (args.label) {
        const label = document.createElement('div');
        label.className = 'hs-label';
        label.textContent = args.label;
        hotSpotDiv.appendChild(label);
      }
    }

    // 4) ç‚¹å‡»è·³è½¬
    function navigateHotspot(event, args) {
      if (!args || !args.url) return;
      if (args.target === '_blank') window.open(args.url, '_blank', 'noopener');
      else location.assign(args.url);
    }
  </script>

  <noscript>
    <div class="fallback" style="display:grid">
      æœ¬é¡µé¢ä¾èµ– JavaScript/WebGLã€‚
      <a href="index.html?desktop=1">å‰å¾€æ¡Œé¢ç‰ˆ</a>
    </div>
  </noscript>
</body>
</html>
